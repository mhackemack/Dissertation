%%
%% This is file `elsarticle-template-num.tex',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% elsarticle.dtx  (with options: `numtemplate')
%% 
%% Copyright 2007, 2008 Elsevier Ltd.
%% 
%% This file is part of the 'Elsarticle Bundle'.
%% -------------------------------------------
%% 
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.2 of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.2 or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%% 
%% The list of all files belonging to the 'Elsarticle Bundle' is
%% given in the file `manifest.txt'.
%% 

%% Template article for Elsevier's document class `elsarticle'
%% with numbered style bibliographic references
%% SP 2008/03/01

%\documentclass[preprint,12pt]{elsarticle}
\documentclass[preprint,10pt]{elsarticle}
%\documentclass[final,3p,times]{elsarticle} 

%% Use the option review to obtain double line spacing
%% \documentclass[authoryear,preprint,review,12pt]{elsarticle}

%% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
%% for a journal layout:
%% \documentclass[final,1p,times]{elsarticle}
%% \documentclass[final,1p,times,twocolumn]{elsarticle}
%% \documentclass[final,3p,times]{elsarticle}
%% \documentclass[final,3p,times,twocolumn]{elsarticle}
%% \documentclass[final,5p,times]{elsarticle}
%% \documentclass[final,5p,times,twocolumn]{elsarticle}

%% if you use PostScript figures in your article
%% use the graphics package for simple commands
%\usepackage{subfigure}
\usepackage{caption}
\usepackage{subcaption}

\usepackage{color}
%% or use the graphicx package for more complicated commands
\usepackage{graphicx}
%% or use the epsfig package if you prefer to use the old commands
\usepackage{epstopdf}

%% The amssymb package provides various useful mathematical symbols 
%% The amsthm package provides extended theorem environments
\usepackage{amssymb}
\usepackage{amsmath}
% more math
\usepackage{amsfonts}
\usepackage{amstext}
\usepackage{amsbsy}
%\usepackage{mathbbol} 

%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers.
\usepackage{lineno}

\journal{Journal of Comp. Phys.}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% operators
\renewcommand{\div}{\vec{\nabla}\! \cdot \!}
\newcommand{\grad}{\vec{\nabla}}
% latex shortcuts
\newcommand{\bea}{\begin{eqnarray}}
\newcommand{\eea}{\end{eqnarray}}
\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}
\newcommand{\bal}{\begin{align}}
\newcommand{\eali}{\end{align}}
\newcommand{\bi}{\begin{itemize}}
\newcommand{\ei}{\end{itemize}}
\newcommand{\ben}{\begin{enumerate}}
\newcommand{\een}{\end{enumerate}}
% DGFEM commands
\newcommand{\jmp}[1]{[\![#1]\!]}                     % jump
\newcommand{\mvl}[1]{\{\!\!\{#1\}\!\!\}}             % mean value
\newcommand{\keff}{\ensuremath{k_{\textit{eff}}}\xspace}
% shortcut for domain notation
\newcommand{\D}{\mathcal{D}}
% vector shortcuts
\newcommand{\vo}{\vec{\Omega}}
\newcommand{\vr}{\vec{r}}
\newcommand{\vn}{\vec{n}}
\newcommand{\vnk}{\vec{\mathbf{n}}}
\newcommand{\vj}{\vec{J}}
\newcommand{\eig}[1]{\| #1 \|_2}

\newcommand{\EI}{\mathcal{E}_h^i}
\newcommand{\ED}{\mathcal{E}_h^{\partial \D^d}}
\newcommand{\EN}{\mathcal{E}_h^{\partial \D^n}}
\newcommand{\ER}{\mathcal{E}_h^{\partial \D^r}}
\newcommand{\reg}{\textit{reg}}

% extra space
\newcommand{\qq}{\quad\quad}
% common reference commands
\newcommand{\eqt}[1]{Eq.~(\ref{#1})}                     % equation
\newcommand{\fig}[1]{Fig.~\ref{#1}}                      % figure
\newcommand{\tbl}[1]{Table~\ref{#1}}                     % table
\newcommand{\sct}[1]{Section~\ref{#1}}                   % section

\newcommand\br{\mathbf{r}}
%\newcommand{\tf}{\varphi}
\newcommand{\tf}{b}

\newcommand{\tcr}[1]{\textcolor{red}{#1}}
\newcommand{\mt}[1]{\marginpar{ {\tiny #1}}}
\newcommand{\Introfigpath}[1]{../../../Document/Rev0/figures/sec_Intro/{#1}}
\newcommand{\Snfigpath}[1]{../../../Document/Rev0/figures/sec_Sn/{#1}}
\newcommand{\BFfigpath}[1]{../../../Document/Rev0/figures/sec_BF/{#1}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   BEGIN DOCUMENT
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frontmatter}

%% Title, authors and addresses

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for theassociated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for theassociated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for theassociated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%\title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%% \author{Name\corref{cor1}\fnref{label2}}
%% \ead{email address}
%% \ead[url]{home page}
%% \fntext[label2]{}
%% \cortext[cor1]{}
%% \address{Address\fnref{label3}}
%% \fntext[label3]{}

%-------------------------
%-------------------------
%\title{Discontinuous Finite Element Solution for Diffusion Equations on Arbitrary Polygonal Meshes}
%\title{Higher-Order Basis Functions for the DGFEM $S_N$ Transport Equation on Arbitrary Polygonal Grids}
\title{Higher-Order Discontinuous Finite Element Discretization for $S_N$ Transport on Arbitrary Polygonal Grids}
%-------------------------
%-------------------------

%% use optional labels to link authors explicitly to addresses:
%% \author[label1,label2]{}
%% \address[label1]{}
%% \address[label2]{}

%-------------------------
\author{Michael W. Hackemack}
\author{Jean C. Ragusa}
\ead{jean.ragusa@tamu.edu}
\address{Department of Nuclear Engineering, Texas A\&M University, College Station, TX 77843, USA}

% \cortext[cor1]{Corresponding author}
%-------------------------

%-------------------------
\begin{abstract}

abstract goes here...
 

\end{abstract}
%-------------------------

%-------------------------
\begin{keyword}
  Radiation Transport \sep
	Arbitrary Polygonal Grids \sep
  Discontinuous Finite Element \sep
	Higher-Order Basis Functions
\end{keyword}
%-------------------------

\end{frontmatter}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\linenumbers

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction} \label{sec::intro}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{itemize}
%\item 
%\item 
%\item 
%\end{itemize}

\tcr
{
\begin{enumerate}
\item introduce continuous, 1G transport equation
\begin{itemize}
\item application of TE (reactors, HDELP, astrophy, medical,...)
\item oin this paper, we focus on solution techniques based on first-order form of the TE, namely, Sn DO in angle and DFEM in space. Why? The spatial disc of Sn transport dates back to Lessain/Raviart 1972, Reed/Hill 1973, and amenable to efficient iterative techniques, matrix-free transport sweeps + DSA precondition. Works well on massively // architectures.  
\item most of DGFEM Sn Transport code (Denovo, Partisn, Capsacin) use linear on simplices and hex grids, except PDT, PWLD Adams on abitrary polyg/h
\item also bring some focus on TDL (thick)
\end{itemize}
\item history of higher-order Sn transport discretizations
\begin{itemize}
\item DGFEM: Reed high-order triangular, Wang (AMR), 
\item nodal method transport (review paper), Azmy AHOT, Wachspress 
\item acknowledge basis functions derived/used here can be employed for other spatial disc of transport on arbitrary grids, SAAF, LS, EP, (CFEM) [some form can be Sn in agle or Pn, e.g., SAAF-PN/SN, EVENT UK Imperial  + RATTLESNAKE). Important to recall this in conclusions. 
\end{itemize}
\item polygonal grids + poly math
\begin{itemize}
\item HOWEVER, all of the above: nada for polygons except PWLD which is only linear
\item why polyg? 4 reasons 
\item Rand/Gillete sukumar
\end{itemize}
\item outline
\begin{itemize}
\item brief review DG/ Sn
\item brief review of linear basis on polygon
\item the meat: (1) application (new) of existing HO basis function to Transport (2) novelty: PWQ on poly
\item AMR
\item results
\end{itemize}
\end{enumerate}
}

We can summarize the benefits of using polygonal meshes as the following:

\begin{enumerate}
	\item Polygonal mesh cells are now being employed in other physics communities - notably computational fluid dynamics (CFD) \cite{ref::star_CCM} and solid mechanics \cite{yip2005automated};
	\item They are believed to reduce the number of unknowns to solve with equivalent accuracy;
	\item They can reduce cell/face counts which can reduce algorithm wallclock times depending on the solution method;
	\item They can allow for transition elements between different portions of the domain (e.g., triangular elements bordering quadrilateral elements at the border of the boundary layer);
	\item They can easily be split along cut planes - allowing the mesh to be partitioned into regular or irregular divisions as well as be generated by simplical meshing techniques across processor sets in parallel;
	\item Hanging nodes from non-conforming meshes, like those that naturally arise from locally refined/adapted meshes as seen in Figure \ref{fig::locally_refined_vertices}, are not necessary. 
\end{enumerate}

% Refined quadrilateral vertices figure
% ---------
\begin{figure}[hbt]
\centering
\includegraphics[width=0.85\textwidth]{\Introfigpath{locally_refined_vertices.png}}
\caption{Local mesh refinement of an initial quadrilateral cell (left) leads to a degenerate pentagonal cell (right) without the use of a hanging node.}
\label{fig::locally_refined_vertices}
\end{figure}
% ---------

% Outline 
% --------
The remainder of the paper is as follows.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The DGFEM $S_N$ Discretization of the Transport Equation} \label{sec::dgfem}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\tcr
{ keep it short
\begin{enumerate}
\item angular discretization
\item DGFEM discretization with upwind scheme
\item theoretical convergence rates (including solution irregularity) Wang + others (Pitkarantka ...)
\end{enumerate}
}

In this section, we review the DGFEM $S_N$ transport equation. Given an angular quadrature set, $\{  \vec{\Omega}_m, w_m \}_{m=1}^M$, the $S_N$ transport equation with isotropic scattering is defined within an open, convex spatial domain $\mathcal{D}$, with boundary, $\partial \mathcal{D}$, as

\begin{equation}
\label{eq::trans_eq_simple_no_energy_groups}
\left( \vec{\Omega}_m \cdot \vec{\nabla}  + \sigma_{t} (\vec{r}) \right)  \psi_{m} (\vec{r})=  \frac{\sigma_{s} (\vec{r})}{4 \pi}  \phi (\vec{r}) + Q_{m} (\vec{r}) ,
\end{equation}

\noindent where $\psi_{m} (\vec{r}) = \psi (\vec{r}, \vec{\Omega}_m)$ is the angular flux at position $\vec{r}$ and in direction $\vec{\Omega}_m$, $\sigma_{t}$ and $\sigma_{s}$ are the total and scattering cross sections, and $Q_{m}$ is a distributed source for angle $m$. The scalar flux is defined as

\begin{equation}
\label{eq::scalar_flux_int}
\phi (\vec{r}) = \int\limits_{4 \pi} d \Omega \, \psi (\vec{r}, \vec{\Omega}) \approx \sum_{m=1}^{M} w_m \psi_{m} (\vec{r}) .
\end{equation}

\noindent We then lay down an unstructured mesh, $\mathbb{T}_h \in \mathbb{R}^{d}$, over the spatial domain, where $d$ is the spatial dimension of the problem (for this work, $d=2$). This mesh consists of non-overlapping spatial elements to form a complete union over the entire spatial domain: $\mathcal{D} = \bigcup_{K \in \mathbb{T}_h} K$. 
The 2D domain is meshed with arbitrary polygonal elements. For each element $K$, there are $n_K$ vertices and $n_K$ edges. As is standard in discontinuous Galerkin scheme, the angular flux unknown of \eqt{eq::trans_eq_simple_no_energy_groups} is expanded using discontinuous basis functions. 
\[
\psi_{m} (\vec{r}) \approx \sum_K \sum_{j=1}^{j=n_K} \psi_{m,j} b_j(\vec{r})
\]
\tcr{to simplify, I decided not to mention that the test function has a subscript $m$\\}
The basis functions are nonzero over a single element and discontinuous across the element interfaces. 
The DGFEM weak form for the transport equation is obtained by multiplying \eqt{eq::trans_eq_simple_no_energy_groups} by a test function $b$, integrating over element $K$, applying the divergence Theorem to the streaming, and using the standard upwind technique for the angular flux at the element's boundaries.  A compact notation for the weak form over  element $K$, for an angular direction $\vec{\Omega}_m$, is as follows:

\begin{equation}
\label{eq::DGFEM_trans_eq_cellK}
\begin{aligned}
 \Big< ( \vec{\Omega}_m \cdot \vec{n} ) \, b, \psi_m  \Big>_{\partial K^+} - \left( \vec{\Omega}_m \cdot  \vec{\nabla} b, \psi_{m} \right)_{K}  + \Big(  \sigma_{t} b ,   \psi_{m} \Big)_{K} \\
=  \left( \frac{\sigma_s}{4 \pi} b ,   \phi \right)_{K} + \left(  b ,   Q_{m} \right)_{K} -  \Big< ( \vec{\Omega}_m \cdot \vec{n} ) \, b, \psi^{\uparrow}_{m}  \Big>_{\partial K^-}
\end{aligned} .
\end{equation}

\noindent In \eqt{eq::DGFEM_trans_eq_cellK}, $\partial K^\pm$ represents the inflow/outflow boundary of element $K$ (with respect to direction $\vec{\Omega}_m$)
\[ \partial K^\pm = \left\{ \vec{r} \in \partial K \ | \ \vec{\Omega}_m \cdot \vec{n}_K(\vec{r}) \gtrless 0 \right\} \,,
\]
with $\vec{n}_K(\vec{r})$ the outward unit normal vector at location $\vec{r}$, $\psi^{\uparrow}_{m}$ are the angular flux values on an inflow face taken from the upwind neighbor element, and the inner products

\begin{equation}
\label{eq::spatial_inner_products_cell}
 \Big( u, v \Big)_K \equiv \int_K u \, v \, d r \qquad \text{and} \qquad  \Big< u, v \Big>_{\partial K} \equiv \int_{\partial K} u \, v \, d s
\end{equation} 

\noindent correspond to integrations over the cell volume and faces, respectively, where $dr \in \mathbb{R}^d$ is within the cell and $ds \in \mathbb{R}^{d-1}$ is along the cell boundary. In \eqt{eq::DGFEM_trans_eq_cellK}, $\partial K^\pm$, all angular flux unknowns ``live on'' element $K$, except for the upwinded values which are taken from the upwind neighboring element:
\[
\psi^{\uparrow}_{m}(\vec{r}) = \lim_{s \to 0^+} \psi_{m}(\vec{r} + s \vec{n}_K(\vec{r}) ) \,,  \quad \vec{r} \in \partial K^- \,.
\]

The spatial convergence of DGFEM methods for the hyperbolic systems has been extensively studied \cite{lesaint1974finite,houston2000stabilized,houston2002discontinuous,wang2009convergence}. With the discretized flux solution, $\phi_h \in W^h_{\mathcal{D}}$, corresponding to our unstructured mesh, $\mathbb{T}_h$, we can define an error for our DGFEM transport solution with the $L_2$ norm as

\begin{equation}
\label{eq::Convergence_L2norm_phi}
|| \phi_h - \phi_{exact} ||_{L_2} \leq C \frac{h^{q}}{(p+1)^{q-1/2}} .
\end{equation}

\noindent In Eq. (\ref{eq::Convergence_L2norm_phi}), $q = \min (p+1, r )$, $h$ is the maximum diameter of all the mesh elements, $p$ is the polynomial completeness of the finite element function space, $r$ is the regularity index of the transport solution, and $C$ is a constant that is independent of the mesh employed.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Linear Polygonal Basis Functions} \label{sec::linpoly}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\tcr
{
\begin{enumerate}
\item Image of geometric terms on general polygon
\item List/description of barycentric properties
\end{enumerate}
}

\begin{figure}
\centering
\includegraphics[width=0.65\textwidth]{\BFfigpath{ref_polygon_Rev1.png}}
\caption{Arbitrary polygon with geometric properties used for 2D basis function generation.}
\label{fig::2D_ref_polygon}
\end{figure}

\begin{enumerate}
\item Positivity: $\lambda_j \geq 0$;
\item Partitiion of unity: $\sum\limits_{j=1}^n \lambda_j = 1$;
\item Affine combination: $\sum\limits_{j=1}^n \vec{r}_j \lambda_j (\vec{r}) = \vec{r}$;
\item Lagrange property: $\lambda_i (\vec{r}_j) = \delta_{ij}$;
\item Piecewise boundary linearity: $\lambda_j ((1-\mu ) \vec{x}_j  + \mu \vec{x}_{j+1})  = (1-\mu ) \lambda_j (\vec{x}_j ) + \mu \lambda_j (\vec{x}_{j+1} )$
\end{enumerate}

%------------------------------------------------------------------------------------------------------------
\subsection{Wachspress Rational Functions}
%------------------------------------------------------------------------------------------------------------

The first linearly-complete polygonal functions that we will consider are the Wachspress rational functions \cite{wachspress1975rational}. These rational functions were the first derived for 2D polygons and possess all the properties of the barycentric coordinates. However, they are only valid interpolants over strictly-convex polygons. Weakly-convex polygons (contain colinear vertices) lose piecewise linearity on the boundary. Concave polygons have regions within their domain that are undefined and divide-by-zero occurs. The Wachspress functions (which we denote as $\lambda^W$) have the following form

\begin{equation}
\label{eq::wach_BF}
\lambda_{j}^{W} (\vec{r}) = \frac{w_j (\vec{r}) }{\sum\limits_{i=1}^{n} w_i (\vec{r})},
\end{equation}

\noindent where the Wachspress weight function for vertex $j$, $w_j$, has the following definition:

\begin{equation}
\label{eq::wach_weights}
w_j (\vec{r})  = \frac{A(\vec{r}_{j-1}, \vec{r}_{j}, \vec{r}_{j+1})}{A(\vec{r}, \vec{r}_{j-1}, \vec{r}_{j}) \, A(\vec{r}, \vec{r}_{j}, \vec{r}_{j+1})} .
\end{equation}

\noindent In Eq. (\ref{eq::wach_weights}), the terms $A(\vec{a}, \vec{b}, \vec{c})$ denote the signed area of the triangle with vertices $\vec{a}$, $\vec{b}$, and $\vec{c}$. Each of these signed areas can be computed by

\begin{equation}
\label{eq::wach_signed_area}
A(\vec{a}, \vec{b}, \vec{c}) = \frac{1}{2}
\left|  
  \begin{array}{ccc}
  1 & 1 & 1 \\
  x_a & x_b & x_c \\
  y_a & y_b & y_c
  \end{array}
\right| .
\end{equation}

\noindent Through observation of Eq. (\ref{eq::wach_weights}), we can see that the denominator of $w_j$ goes to zero on 

%------------------------------------------------------------------------------------------------------------
\subsection{Piecewise Linear Functions}
%------------------------------------------------------------------------------------------------------------

The second linearly-complete 2D polygonal functions that we will analyze are the Piecewise Linear (PWL) functions proposed by Stone and Adams \cite{ref::PWLD_stone_adams,ref::PWLD_stone_adams_unstructured}. The 2D PWL functions are defined as combinations of linear triangular functions, with some of them only having measure within a subregion of a polygon. These subregions are formed by triangulating the arbitrary 2D polygon into a set of sub-triangles.  Each sub-triangle is defined by two adjacent vertices of the polygon and the polygon's centroid, $\vec{r}_{c}$. The polygon's centroid can be defined by

\begin{equation}
\label{eq::PWL_2D_centroid}
	\vec{r}_{c} =  \sum\displaylimits_{j=1}^{n} \alpha_{j} \vec{r}_j ,
\end{equation}

\noindent where $\alpha_{j}$ are the vertex weights functions and, 

\begin{equation}
\label{eq::PWL_2D_vertex_weight_sum}
 \sum\displaylimits_{j=1}^{n} \alpha_{j} = 1.
\end{equation}

\noindent For this work, we continue to use the definition for the vertex weight functions from previous works \cite{ref::PWLD_stone_adams,ref::PWLD_stone_adams_unstructured,bailey2008phd}: $\alpha_{j}= 1/n$. Therefore, the vertex weight functions are the same for every vertex, and the cell centroid simply becomes the average position of all the vertices. Using these vertex weight functions, the PWL basis function for vertex $j$, $\lambda_j^{PWL}$, is defined as

\begin{equation}
\label{eq::PWL_2D}
\lambda_j^{PWL} (\vec{r}) = t_j (\vec{r}) + \alpha_j t_c (\vec{r}) .
\end{equation}

\noindent In Eq. (\ref{eq::PWL_2D}), $t_j$ is the standard 2D linear function with unity at vertex $j$ that linearly decreases to zero at the cell center and each adjoining vertex. $t_c$ is the 2D cell ``tent'' function located at $\vec{r}_{c}$ which is unity at the cell center and linearly decreases to zero at each cell vertex. $\alpha_{j}$ is the weight parameter for vertex $j$. The functional form of Eq. (\ref{eq::PWL_2D}) with identical vertex weights means that the PWL function for vertex $j$, within the domain of the polygon, linearly decreases to a value of $1/n$ at the polygonal center. From there, the function linearly decreases to zero on all faces that are not connected to vertex $j$.

%------------------------------------------------------------------------------------------------------------
\subsection{Mean Value Coordinates}
%------------------------------------------------------------------------------------------------------------

The third linearly-complete 2D polygonal funcitons that we will analyze are the mean value coordinates (MV) \cite{floater2003mean,floater2015generalized}. These functions were derived to approximate harmonic maps on a polygon by a set of piecewise linear maps over a triangulation of the polygon for use in computer aided graphic design. The mean value function at vertex $j$, $\lambda_{j}^{MV}$, is defined as

\begin{equation}
\label{eq::MV_BF}
\lambda_{j}^{MV} (\vec{r}) = \frac{w_j (\vec{r}) }{\sum\limits_{i=1}^{n} w_i (\vec{r})} ,
\end{equation}

\noindent where the mean value weight function for vertex $j$, $w_j$, has the following definition:

\begin{equation}
\label{eq::MV_weights}
w_j (\vec{r})  = \frac{\tan(\alpha_{j-1} / 2) + \tan(\alpha_j / 2)}{|\vec{r}_j - \vec{r}|}.
\end{equation}

%------------------------------------------------------------------------------------------------------------
\subsection{Maximum Entropy Coordinates}
%------------------------------------------------------------------------------------------------------------

\tcr{short history and functional form}

\begin{equation}
\label{eq::ME_BF}
\lambda_{j}^{ME} (\vec{r}) = \frac{w_j (\vec{r}) }{\sum\limits_{i=1}^{n} w_i (\vec{r})} ,
\end{equation}

\noindent where the maximum entropy weight function for vertex $j$, $w_j$, has the following definition,

\begin{equation}
\label{eq::ME_weights}
w_j (\vec{r})  = m_j(\vec{r}) \exp(-  \vec{\kappa} \cdot (\vec{r}_j - \vec{r})),
\end{equation}

\noindent and $\vec{\kappa}$ is a vector value of dimension 2 that will be explained shortly. In the context of Eq. (\ref{eq::ME_weights}), the prior distribution, $m_j$, can be viewed as a weight function associated with vertex $j$. This means that there is variability that one can employ for these weight functions. For FEM applications, an appropriate functional form for the prior distribution is given by

\begin{equation}
\label{eq::ME_prior_funcs}
 m_j(\vec{r}) = \frac{\pi_j (\vec{r}) }{\sum\limits_{k=1}^{n} \pi_k (\vec{r})},
\end{equation}

\noindent where

\begin{equation}
\label{eq::ME_prior_products}
\pi_j (\vec{r}) = \prod\limits_{k \neq j-1, j}^{n} \rho_k (\vec{r})  = \rho_1(\vec{r}) \ldots \rho_{j-2}(\vec{r}) \rho_{j+1}(\vec{r}) \ldots \rho_{n}(\vec{r}) ,
\end{equation}

\noindent and

\begin{equation}
\label{eq::ME_face_funcs}
\rho_j (\vec{x}) = || \vec{x} - \vec{x}_j || + || \vec{x} - \vec{x}_{j+1} || - || \vec{x}_{j+1} - \vec{x}_j || .
\end{equation}

%------------------------------------------------------------------------------------------------------------
\subsection{Summary of the Linear Polygonal Basis Functions}
%------------------------------------------------------------------------------------------------------------

\tcr
{
\begin{enumerate}
\item table with summary
\item example contour plots (small)
\end{enumerate}
}

\begin{table}[hbt]
\centering
\caption{Summary of the properties of the 2D coordinate systems used on polygons.}
\begin{tabular}{|c|c|c|c|c|}
\hline
Basis Function & Dimension & Polygon Type & Integration & Evaluation \\
\hline \hline
Wachspress	&2D/3D&	Convex&	Numerical	&Direct\\ \hline
PWL&	1D/2D/3D&	Convex/Concave&	Analytical	&Direct\\ \hline
Mean Value&	2D&	Convex/Concave&	Numerical	&Direct\\ \hline
Max Entropy&	1D/2D/3D	&Convex/Concave&	Numerical&	Iterative\\ \hline
\end{tabular}
\label{tab::2Dlin_summary}
\end{table}

% Linear contour plots
% -----------------------
\begin{figure}[hbt]
\centering
{
	\begin{subfigure}[b]{0.325\textwidth}
		\centering
		\includegraphics[width=\textwidth]{\BFfigpath{square_WACHSPRESS1_contour_b4.png}}
		\caption{Wachspress}
	\end{subfigure}
	\hspace{1.25cm}
	\begin{subfigure}[b]{0.325\textwidth}
		\centering
		\includegraphics[width=\textwidth]{\BFfigpath{square_PWLD1_contour_b4.png}}
		\caption{PWL}
	\end{subfigure}
}
	\vspace{3mm}
{
	\begin{subfigure}[b]{0.325\textwidth}
		\centering
		\includegraphics[width=\textwidth]{\BFfigpath{square_MV1_contour_b4.png}}
		\caption{Mean Value}
	\end{subfigure}
	\hspace{1.25cm}
	\begin{subfigure}[b]{0.325\textwidth}
		\centering
		\includegraphics[width=\textwidth]{\BFfigpath{square_MAXENT1_contour_b4.png}}
		\caption{Maximum Entropy}
	\end{subfigure}
}
\caption{Contour plots of the different linear basis function on the unit square located at vertex (0,1).}
\label{fig::Linear_unit_square_basis_functions}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Quadratic Serendipity Polygonal Basis Functions} \label{sec::quadpoly}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tcr
{
\begin{enumerate}
\item Image of conversion procedure
\item conversion methodology
\item example contour plots
\end{enumerate}
}


% HATCHET JOB OF TEXT STARTS HERE!!!!
% -------------------------------------------------



We have given complete details on the linearly-complete generalized barycentric coordinates that we will investigate for this work. Now we describe how to convert any generalized barycentric coordinate into the quadratic serendipity space of functions to yield quadratic (not linear) precision based on the work of Rand et al. \cite{rand2014quadratic}. The maximum entropy coordinates were independently converted into the quadratic space \cite{gonzalez2010higher,sukumar2013quadratic}. These 2D serendipity coordinates can exactly interpolate the $\{ 1, x, y, x^2, xy, y^2 \}$ span of functions, which can be shown with the first three levels of Pascal's triangle:

\begin{equation}
\label{eq::BF_quad_pascal}
\begin{array}{ccccc}
 & & 1 & & \\
 & x & & y & \\
 x^2 &  &xy & & y^2 
\end{array} \, 
\end{equation}

\noindent Between the linear and quadratic precision of the generalized barycentric coordinates and the quadratic serendipity extension, a relation can be formed on the functional space of their precision. If we seek a functional space up to order $p$ precision, then for $k=0,...,p$, the interpolatory functions must exactly span the following monomial functions,

\begin{equation}
\label{eq::BF_quad_monomial}
f_{\sigma, \tau}^k (x, y) = x^{\sigma} y^{\tau} ,
\end{equation}

\noindent where $\sigma + \tau = k$. From the first three levels of Pascal's triangle given in Eq. (\ref{eq::BF_quad_pascal}), we see that $k=0$ gives the constant function $\{ 1 \}$, that $k=1$ gives the linear functions $\{ x,y \}$, and that $k=2$ gives the quadratic functions $\{ x^2,xy,y^2 \}$.

% serendipity overview figure
% ---------
\begin{figure}[hbt]
\centering
\includegraphics[width=0.90\textwidth]{\BFfigpath{linear_to_quad_process.png}}
\caption{Overview of the process to construct the quadratic serendipity basis functions on polygons. The filled dots correspond to basis functions that maintain the Lagrange property while empty dots do not.}
\label{fig::BF_2D_quad_process}
\end{figure}
% ---------

Now, we give the full details on converting the linear generalized barycentric coordinates to the quadratic serendipity space of functions. Figure \ref{fig::BF_2D_quad_process} gives a visual depiction of this conversion process. For a polygon with $n$ vertices, we can summarize this procedure as the following:

\begin{enumerate}
\item For a point $\vec{x}$, compute the $n$ linear barycentric functions $\{ \lambda_i (\vec{x}) \}$ (Wachspress, PWL, mean value, or maximum entropy);
\item Take all non-repeating pairwise products of the linear functions to obtain $\frac{n(n+1)}{2}$ quadratic functions $\{ \mu_{ab} \}$;
\item Form the linear transformation matrix $\mathbb{A}$ through the use of monomial constraint equations;
\item Use the $\mathbb{A}$ matrix to reduce the $\{ \mu_{ab} \}$ function set to the $2 n$ serendipity basis set $\{ \xi_{ij} \}$.
\end{enumerate}

We begin by computing the ($i=1,...,n$) linear barycentric functions, $\{ \lambda_i (\vec{x}) \}$, and their gradients, $\{ \vec{\nabla} \lambda_i (\vec{x}) \}$, for a point $\vec{x}$. These linearly-complete barycentric functions can be converted immediately to barycentric-like functions with quadratic precision. Taking all non-repeating pairwise products of the linear functions yields a total of $N_Q=\frac{n(n+1)}{2}$ quadratic functions: $\mu_{ab} = \lambda_a \lambda_b$. Doing this generates functions that either live on the polygon's vertices, mid-face points, or midpoints of the polygon's diagonals between two vertices as seen in Figure \ref{fig::BF_2D_quad_process}. The $n$ vertex functions are denoted as $ab \in V$ ($a=b$), the $n$ mid-face (mid-edge) functions are denoted as $ab \in E$ ($|a-b|=1$), and the $\frac{n(n-3)}{2}$ diameter (interior) functions are denoted as $ab \in D$ ($|a-b| > 1$). For the mid-edge and interior functions, only 1 combination of $ab$ is kept since $\mu_{ab}=\mu_{ba}$. We also define the abbreviated notation of $\vec{x}_{ab} = \frac{\vec{x}_a + \vec{x}_b}{2}$, so that $\vec{x}_{aa}$ corresponds to a vertex function at $\vec{x}_a$. Using these various notations, we can write the precision properties of the $\mu_{ab}$ functions for the constant constraint,

\begin{equation}
\label{eq::BF_quad_interp_req_constant_alt}
\sum_{aa \in V}  \mu_{aa} (\vec{x}) + \sum_{ab \in E \cup D} 2 \mu_{ab} (\vec{x})  = 1 ,
\end{equation}

\noindent for the linear constraint,

\begin{equation}
\label{eq::BF_quad_interp_req_linear_alt}
\sum_{aa \in V}  \mu_{aa} (\vec{x}) \, \vec{x}_{aa} +  \sum_{ab \in E \cup D} 2  \mu_{ab} (\vec{x}) \, \vec{x}_{ab} = \vec{x} ,
\end{equation}

\noindent and for the quadratic constraint,

\begin{equation}
\label{eq::BF_quad_interp_req_quadratic_alt}
\sum_{aa \in V}  \mu_{aa} (\vec{x}) \, \left( \vec{x}_a \otimes \vec{x}_a \right) +  \sum_{ab \in E \cup D}   \mu_{ab} (\vec{x}) \, \left( \vec{x}_a \otimes \vec{x}_b + \vec{x}_b \otimes \vec{x}_a \right)   =  \vec{x} \otimes \vec{x} .
\end{equation}


\noindent In Eq. (\ref{eq::BF_quad_interp_req_quadratic_alt}), $\otimes$ is the dyadic tensor product. We can immediately see that quadratic precision is ensured. However, the set of these pairwise quadratic functions grows quadratically. This means that as $n$ grows large, the number of interpolatory functions grows as order $O(n^2)$, but still only maintains precision of the $\{ 1, x, y, x^2, xy, y^2 \}$ span of functions. Therefore, the computational work required to utilize these quadratic barycentric functions can become prohibitive for polygons with large vertex counts.

To minimize the number of interpolatory functions but still maintain the precision of the $\{ 1, x, y, x^2, xy, y^2 \}$ span of functions, we seek to convert the quadratic barycentric functions into the quadratic serendipity space of functions $\{ \xi_{ij} \}$. This quadratic serendipity space only contains the vertex and mid-face functions (total of $2 n$) and has been extensively studied for tensor-based elements in the past \cite{macneal1992eight,arnold2011serendipity}. This means that we seek to reduce the $\{ \mu_{ab} \}$ set of functions by removing the diagonal functions ($ab \in D$) while still maintaining quadratic precision. If we define $\xi_{ii}$ and $\xi_{i(i+1)}$ as the serendipity functions that live at vertex $i$ and the mid-face point between vertices $i$ and $i+1$, respectively, then we can write the serendipity precision properties for the constant constraint,

\begin{equation}
\label{eq::BF_ser_interp_req_constant}
\sum_{ii \in V}  \xi_{ii} (\vec{x}) + \sum_{i(i+1) \in E} 2 \xi_{i(i+1)} (\vec{x})  = 1 ,
\end{equation}

\noindent for the linear constraint,

\begin{equation}
\label{eq::BF_ser_interp_req_linear}
\sum_{ii \in V}  \xi_{ii} (\vec{x}) \, \vec{x}_{ii} +  \sum_{i(i+1) \in E} 2  \xi_{i(i+1)} (\vec{x}) \, \vec{x}_{i(i+1)} = \vec{x} ,
\end{equation}

\noindent and for the quadratic constraint,

\begin{equation}
\label{eq::BF_ser_interp_req_quadratic}
\sum_{ii \in V}  \xi_{ii} (\vec{x}) \, \left( \vec{x}_i \otimes \vec{x}_i \right) +  \sum_{i(i+1) \in E}   \xi_{i(i+1)} (\vec{x}) \, \left( \vec{x}_i \otimes \vec{x}_{i+1} + \vec{x}_{i+1} \otimes \vec{x}_i \right)   =  \vec{x} \otimes \vec{x} .
\end{equation}

To remove the diagonal functions, we formalize this procedure by recasting it as a linear algebra problem. We seek a matrix $\mathbb{A}$ such that the linear transformation, 

\begin{equation}
\label{eq::BF_quad_to_ser_mapping}
\left\{ \xi \right\} = \mathbb{A} \left\{ \mu \right\} ,
\end{equation}

\noindent will satisfy the precision properties of Eqs. (\ref{eq::BF_ser_interp_req_constant} - \ref{eq::BF_ser_interp_req_quadratic}). It is easy to see that $\mathbb{A}$ has dimension ($2 n \times N_Q$). We wish for this matrix to have constant entries for any point within the polygon's interior so that it does not have to be recalculated for each interpolatory point of interest. To ease the notation, we will assign specific basis orderings for the quadratic and quadratic serendipity functions. The serendipity basis is ordered such that all vertex functions ($ii \in V$) in a counter-clockwise ordering are first, followed by a counter-clockwise ordering of the mid-face nodes ($ij \in E$) starting with the node between vertices 1 and 2. This ordering can be succinctly stated by

\begin{equation}
\label{eq::BF_ser_ordering}
\left\{ \xi_{ij} \right\} = \Big\{ \left[  \xi_{11}, \xi_{22}, ... , \xi_{n n} \right] , \left[ \xi_{12}, \xi_{23}, ..., \xi_{(n-1)n}, \xi_{n(n+1)} \right] \Big\} ,
\end{equation}

\noindent where $n+1=1$. The quadratic basis begins identically to the serendipity basis by first listing the vertex and mid-face functions. Then the diagonal functions are indexed in lexicographical order. This gives the following ordering for the quadratic functions

\begin{equation}
\label{eq::BF_quad_ordering}
\begin{aligned}
\left\{ \mu_{ab} \right\} = \Big\{ \left[  \mu_{11}, \mu_{22}, ... , \mu_{n n} \right] , &\left[ \mu_{12}, \mu_{23}, ..., \mu_{(n-1)n}, \mu_{n(n+1)} \right] ,\\ 
&\left[ \mu_{13}, ..., \text{(lexicographical)} ,..., \mu_{(n-2)n} \right] \Big\} 
\end{aligned} .
\end{equation}

\noindent With these basis orderings, we can now denote the entries of $\mathbb{A}$ (given by $c_{ab}^{ij}$) as

\begin{equation}
\label{eq::BF_quad_to_ser_matrix_constraints}
\mathbb{A} = 
\left[
\begin{array}{ccccc}
c_{11}^{11} & \ldots & c_{ab}^{11} & \ldots & c_{(n-2)n}^{11} \\
\ldots&\ddots&\vdots&\ddots&\vdots \\
c_{11}^{ij} & \ldots & c_{ab}^{ij} & \ldots & c_{(n-2)n}^{ij} \\
\ldots&\ddots&\vdots&\ddots&\vdots \\
c_{11}^{n(n+1)} & \ldots & c_{ab}^{n(n+1)} & \ldots & c_{(n-2)n}^{n(n+1)} 
\end{array}
\right] ,
\end{equation}

A sufficient set of constraints for the entries in $\mathbb{A}$ to ensure the precision properties of Eqs. (\ref{eq::BF_ser_interp_req_constant} - \ref{eq::BF_ser_interp_req_quadratic}) can be written for the constant constraint,

\begin{equation}
\label{eq::BF_Amat_cons_constraints}
\begin{aligned}
\sum_{ii \in V} c_{aa}^{ii} + \sum_{i(i+1) \in E} 2 c_{aa}^{i(i+1)} = 1, &\qquad \forall aa \in V \\
\sum_{ii \in V} c_{ab}^{ii} + \sum_{i(i+1) \in E} 2 c_{ab}^{i(i+1)} = 2, &\qquad \forall ab \in E \cup D
\end{aligned}
\end{equation}

\noindent for the linear constraint,

\begin{equation}
\label{eq::BF_Amat_lin_constraints}
\begin{aligned}
\sum_{ii \in V} c_{aa}^{ii} \vec{x}_{ii} + \sum_{i(i+1) \in E} 2 c_{aa}^{i(i+1)} \vec{x}_{i(i+1)} = \vec{x}_{aa}, &\qquad \forall aa \in V \\
\sum_{ii \in V} c_{ab}^{ii} \vec{x}_{ii} + \sum_{i(i+1) \in E} 2 c_{ab}^{i(i+1)} \vec{x}_{i(i+1)} = 2 \vec{x}_{ab}, &\qquad \forall ab \in E \cup D
\end{aligned}
\end{equation}

\noindent for the $a\in V$ vertex quadratic constraints

\begin{equation}
\label{eq::BF_Amat_quad_vert_constraints}
\sum_{ii \in V} c_{aa}^{ii} \vec{x}_{ii} \otimes \vec{x}_{ii} + \sum_{i(i+1) \in E}  c_{aa}^{i(i+1)} \left( \vec{x}_i \otimes \vec{x}_{i+1} + \vec{x}_{i+1} \otimes \vec{x}_i \right) = \vec{x}_{aa} \otimes \vec{x}_{aa}, 
\end{equation}

\noindent and for the $ab \in E \cup D$ mid-face and diagonal quadratic constraints,

\begin{equation}
\label{eq::BF_Amat_quad_facediag_constraints}
\sum_{ii \in V} c_{ab}^{ii} \vec{x}_{ii} \otimes \vec{x}_{ii} + \sum_{i(i+1) \in E}  c_{ab}^{i(i+1)} \left( \vec{x}_i \otimes \vec{x}_{i+1} + \vec{x}_{i+1} \otimes \vec{x}_i \right) = \left( \vec{x}_a \otimes \vec{x}_{b} + \vec{x}_{b} \otimes \vec{x}_a \right).
\end{equation}

\noindent For $n > 3$, there are more coefficients than the six constraint equations. This means that there is flexibility in the construction of the solution to the constraint equations. Therefore, we choose a simple structure for $\mathbb{A}$ that consists of the following,


\begin{equation}
\label{eq::BF_quad_Amat_simple}
\mathbb{A} = \left[ \mathbb{I} \, | \, \mathbb{A}' \right],
\end{equation}

\noindent where $\mathbb{I}$ is the ($2 n \text{x} 2 n$) identity matrix, and $\mathbb{A}'$ is a full ($2 n \text{x}  \frac{n(n-3)}{2}$) matrix. This means that the vertex and face midpoint serendipity functions, $\xi_{ij}$, are formed by taking their corresponding quadratic function, $\mu_{ij}$, and adding some linear combination of the interior functions. Therefore, we only need to determine the $\frac{n(n-3)}{2}$ columns of the $\mathbb{A}'$ matrix to complete this linear transformation. 

In their work, Rand et al. proposed a methodology where only six coefficients are chosen to be non-zero and can be directly calculated through geometric expressions. However, their approach is only valid for strictly-convex polygons. This will not work for our analysis since we wish to also analyze degenerate polygons that will arise in our AMR calculations. Therefore, we will use a least squares method to calculate each of the columns of $\mathbb{A}'$. We note that the coefficients calculated with this least squares method and that of Rand will be identical only for rectangles. If we isolate the column $(ab)$ from $\mathbb{A}'$, then we can form the following system of equations, 

\begin{equation}
\label{eq::BF_quad_MP_form}
\mathbb{B} \vec{c}_{ab} = \vec{q}_{ab}, 
\end{equation}

\noindent where $\mathbb{B}$ is a matrix of dimension $(6 \text{x} 2 n)$, $\vec{c}_{ab}$ is vector of length $2 n$, and $\vec{q}_{ab}$ is a vector of length 6. The entries of $\mathbb{B}$ correspond to coefficients given in the left-hand-side terms of Eqs. (\ref{eq::BF_Amat_cons_constraints}), (\ref{eq::BF_Amat_lin_constraints}), and (\ref{eq::BF_Amat_quad_facediag_constraints}). The values of $\vec{q}_{ab}$ are given by the right-hand-side constants of these same equations. To invert $\mathbb{B}$, we use the Moore-Penrose pseudoinverse (denoted as $\mathbb{B}^*$) \cite{penrose1955generalized}. For an under-determined system of equations, the pseudoinverse is given by,

\begin{equation}
\label{eq::BF_quad_MP_inverse}
\mathbb{B}^* = \mathbb{B}^T (\mathbb{B} \mathbb{B}^T)^{-1}.
\end{equation}

\noindent We note that we have only tested this methodology on convex and weakly-convex polygons. Once all of the coefficients for the $\mathbb{A}'$ matrix are known, each of the quadratic serendipity functions can be computed by

\begin{equation}
\label{eq::BF_quad_xi_reduced}
\begin{aligned}
\xi_{ij} &=  \mu_{i,j} + \sum_{ab \in D} c_{ab}^{ij} \mu_{ab} \\
&=  \lambda_i \lambda_j + \sum_{ab \in D} c_{ab}^{ij}\lambda_a \lambda_b
\end{aligned} ,
\end{equation}

\noindent where $i=j$ for vertex functions.



% HATCHET JOB OF TEXT ENDS HERE!!!!
% ----------------------------------------------





% Quadratic contour plots - b4
% ----------------------------------
\begin{figure}[hbt]
\centering
{
	\begin{subfigure}[b]{0.30\textwidth}
		\centering
		\includegraphics[width=0.9\textwidth]{\BFfigpath{square_WACHSPRESS2_contour_b4.png}}
		\caption{Wachspress}
	\end{subfigure}
	\hspace{1.25cm}
	\begin{subfigure}[b]{0.30\textwidth}
		\centering
		\includegraphics[width=0.9\textwidth]{\BFfigpath{square_PWLD2_contour_b4.png}}
		\caption{PWL}
	\end{subfigure}
}
	\vspace{3mm}
{
	\begin{subfigure}[b]{0.30\textwidth}
		\centering
		\includegraphics[width=0.9\textwidth]{\BFfigpath{square_MV2_contour_b4.png}}
		\caption{Mean Value}
	\end{subfigure}
	\hspace{1.25cm}
	\begin{subfigure}[b]{0.30\textwidth}
		\centering
		\includegraphics[width=0.9\textwidth]{\BFfigpath{square_MAXENT2_contour_b4.png}}
		\caption{Maximum Entropy}
	\end{subfigure}
}
\caption{Contour plots of the different quadratic serendipity basis function on the unit square located at vertex (0,1).}
\label{fig::Quad_unit_square_basis_functions_b4}
\end{figure}

% Quadratic contour plots - b8
% ----------------------------------
\begin{figure}[hbt]
\centering
{
	\begin{subfigure}[b]{0.30\textwidth}
		\centering
		\includegraphics[width=0.9\textwidth]{\BFfigpath{square_WACHSPRESS2_contour_b8.png}}
		\caption{Wachspress}
	\end{subfigure}
	\hspace{1.25cm}
	\begin{subfigure}[b]{0.30\textwidth}
		\centering
		\includegraphics[width=0.9\textwidth]{\BFfigpath{square_PWLD2_contour_b8.png}}
		\caption{PWL}
	\end{subfigure}
}
	\vspace{3mm}
{
	\begin{subfigure}[b]{0.30\textwidth}
		\centering
		\includegraphics[width=0.9\textwidth]{\BFfigpath{square_MV2_contour_b8.png}}
		\caption{Mean Value}
	\end{subfigure}
	\hspace{1.25cm}
	\begin{subfigure}[b]{0.30\textwidth}
		\centering
		\includegraphics[width=0.9\textwidth]{\BFfigpath{square_MAXENT2_contour_b8.png}}
		\caption{Maximum Entropy}
	\end{subfigure}
}
\caption{Contour plots of the different quadratic serendipity basis function on the unit square located at vertex (0,1/2).}
\label{fig::Quad_unit_square_basis_functions_b8}
\end{figure}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Adaptive Mesh Refinement Using Polygonal Basis Functions} \label{sec::amr}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tcr{overview of AMR for transport calculations}

Adaptive Mesh Refinement (AMR) techniques have become more commonplace across many scientific and engineering fields over the last couple of decades \cite{plewa2005adaptive,carey1997computational,ramm2003error,karniadakis2013spectral,schwab1998p,solin2003higher}. However, while this has become more common practice in other disciplines, the use of AMR for the transport equation is still in its infancy \cite{fuhrer1997posteriori,hartmann2002adaptive,dedner2002adaptive,hartmann2003adaptive,ragusa2010two,wang2011standard}. For this work, we will only utilize {\em h}-type refinement strategies for 2D transport problems on initial meshes with only quadrilateral cells. 

Figure \ref{fig::Sn_Solution_Spatial_AMR_flowchart} provides the logical flow chart used to perform the mesh adaptation procedures for our problem of interest. The AMR procedure begins with an initial and typically coarse mesh. The transport solution is calculated on this mesh with appropriate PDE solvers. Once this solution is determined, {\em a posteriori} error estimates are used to determine which problem regions contain the largest spatial discretization error \cite{verfurth1996review,ainsworth2011posteriori}. Then, based on some refinement criterion, some subset of mesh elements are flagged for local refinement. From these flagged elements, the mesh can be refined, and a new and more accurate solution can further be obtained. This process is repeated until some global convergence criterion is satisfied or some number of mesh adaptation cycles are performed.

At the heart of the mesh adaptation procedures is the reliance on an accurate estimation of the numerical solution error. The state-of-the-art error estimators rely on either adjoint-based methods \cite{fuhrer1997posteriori,hartmann2002adaptive,hartmann2003adaptive} or projection-based methods \cite{demkowicz2006computing}. However, these methods require an additional calculation of the solution at each refinement level in a richer (and more difficult to solve) functional space. Therefore, we will employ a simpler error estimator that does not require an additional solution calculation. For this work, we will utilize the jump-based error estimator since it is the most straightforward to define and execute. The estimate of the error for mesh cell $K$ of the mesh at refinement level $r$, $\mathbb{T}_h^r$, is given by the following, 

\begin{equation}
\label{eq::Sn_AMR_jump_err_est}
\eta_K^r = \int\displaylimits_{\partial K} [\![ \Phi^r ]\!]^2 d \, s = \int\displaylimits_{\partial K} \left(  \sum_m w_m [\![ \Psi_m^r ]\!]  \right)^2 ,
\end{equation}

\noindent where $[\![ \cdot ]\!]$ is the jump operator along a face defined as,

\begin{equation}
\label{eq::Sn_AMR_jump_def}
[\![ \Phi (\vec{r}) ]\!] = \Phi^+ (\vec{r}) - \Phi^- (\vec{r}),
\end{equation}

\noindent and the terms, $\Phi^+ (\vec{r})$ and $\Phi^- (\vec{r})$, are subject to the trace:

\begin{equation}
\label{eq::Sn_AMR_jump_trace}
\Phi^{\pm} (\vec{r})  = \lim\displaylimits_{s \rightarrow 0^{\pm}} \Phi (\vec{r} + s \vec{n}).
\end{equation}

\noindent In this case, the outward normal, $\vec{n}$, is determined with respect to the element $K$ along its boundary, $\partial K$. With this trace, $\Phi^- (\vec{r})$ always corresponds to the solution within cell $K$. Investigating face $f$ of cell $K$, the across-face solution, $\Phi^+ (\vec{r})$, is dependent on the boundary type of face $f$. The across-face solutions can be succinctly written:

\begin{equation}
\label{eq::Sn_AMR_across_face_vals}
\Phi^+ (\vec{r}) = 
\begin{cases}
\lim\displaylimits_{s \rightarrow 0^{+}} \Phi (\vec{r} + s \vec{n}) & \vec{r} \notin \partial \mathcal{D} \\
\sum\displaylimits_{\vec{\Omega}_m \cdot \vec{n} > 0}  \Psi_m^- (\vec{r}) + \sum\displaylimits_{\vec{\Omega}_m \cdot \vec{n} < 0} \Psi_{m}^{inc} (\vec{r}) & \vec{r} \in \partial \mathcal{D}^d \\
\Phi^- (\vec{r}) & \vec{r} \in \partial \mathcal{D}^r
\end{cases}.
\end{equation}

\noindent From Eq. (\ref{eq::Sn_AMR_across_face_vals}), the across-face solutions for interior faces, incident boundaries and reflecting boundaries have different meanings. For an interior face $f$ ($\vec{r} \notin \partial \mathcal{D}$), the across-face solution comes from the cell $K'$ (as defined by Figure \ref{fig::Sn_two_ref_cells}). For incident boundaries ($\vec{r} \in \partial \mathcal{D}^d$), the across-face solution is a combination of integrals of the outgoing ($\Psi_m^-$) and incident boundary fluxes ($\Psi_m^{inc}$). Finally, for reflecting boundaries ($\vec{r} \in \partial \mathcal{D}^r$), the across-face solutions are simply the within-cell solutions. Therefore, the solution jump is exactly zero for all reflecting boundaries and yields no contribution to the error estimate.

With the error estimates defined for all cells $K \in \mathbb{T}_h^r$ for refinement level $r$, a criterion is needed to determine which cells should be refined. For this work, we choose to employ a refinement criterion of the following form,

\begin{equation}
\label{eq::Sn_AMR_err_crit}
\eta_K^r \geq \alpha \max\displaylimits_{K' \in \mathbb{T}_h^r} \left(  \eta_{K'}^{r} \right),
\end{equation}

\noindent where $\alpha$ is a user-defined value $(0,1)$. This refinement criterion has a simple meaning. If, for example, $\alpha = 0.2$, then a cell will be refined if its error estimate is greater than 20\% of the cell with the largest error estimate. This does not necessarily mean that 80\% of the mesh cells will be refined at level $r$. Instead, the criterion simply states that any cell above a particular threshold will be refined. This means that it is theoretically possible for the extreme cases of 1 or all cells being refined at a particular refinement cycle. The first extreme case could arise with a single spatial cell having a strong solution discontinuity stemming from a strong localized source. The second extreme case could arise when the intercell solution jumps are about equivalent stemming from an incredibly smooth discretized solution at that particular refinement cycle. We could also enforce a uniform refinement of all the spatial cells by setting $\alpha=0$.

Once we have determined which elements on mesh level $r$ to refine, we then form our new adapted mesh on level $r+1$ by a combination of logical refinement rules, hierarchical elements, and refinement trees. Each quadrilateral mesh cell with vertices flagged for refinement (which we denote as the parent element) is further subdivided into four smaller quadrilateral cells (which we denote as daughter elements I, II, III, and IV) that maintain the overall shape of the original mesh cell. If the parent element is denoted by the vertices (1), (2), (3), and (4), then the refinement rules, including the new local ordering of each daughter element's vertices, are given in Figure \ref{fig::Sn_Solution_Spatial_AMR_quadrefrules}. These refinement rules are detailed as follows:

\begin{enumerate}
\item Daughter element I is placed near original vertex (1).
\item Daughter element II is placed near original vertex (2).
\item Daughter element III is placed near original vertex (3).
\item Daughter element IV is placed near original vertex (4).
\item The local numbering of the daughter element vertices is consistent with the parent element.
\item The vertices of the daughter elements common with the original element inherit the same local numbering.
\end{enumerate}

\noindent These refinement rules guarantee that we will maintain logical consistency with our counter-clockwise ordering of the element vertices. This consistency is important for the computation of the polytope basis functions that are presented in Chapter \ref{sec::BF}.

Once a mesh element from level $r$ has been refined, we need to incorporate its daughter elements into the adapted mesh, $\mathbb{T}_h^{r+1}$. We can see from the nesting refinement process that these AMR procedures lead to a hierarchical representation of the mesh. All of the mesh cells are obtained by subdivisions of cells from the initial mesh, $\mathbb{T}_h^0$. This hierarchical nature of the mesh can succinctly be described in a tree structure. We give an example of this tree structure in Figure \ref{fig::Sn_Solution_Spatial_AMR_tree} for the simple case of a 2-cell domain that undergoes two refinement cycles with 1 cell refined per cycle. From the tree structure in Figure \ref{fig::Sn_Solution_Spatial_AMR_tree_struct}, we introduce the concept of an individual element's {\em refinement level}, $\ell(K)$, for mesh cell $K$. The refinement level $\ell(K)$ denotes how many times a cell from the original mesh, $\mathbb{T}_h^0$, has been refined to form element $K$. By convention, the refinement level for all elements in the original mesh is 0. We note that an element's refinement level is not necessarily the number of refinement cycles that have been performed. In Figure \ref{fig::Sn_Solution_Spatial_AMR_tree_struct}, we can see three distinct refinement levels that are represented by the three different vertical levels of nodes. Element 1 has a level of 0 since it was never refined. Elements 2, 3, 4, and 5 have a level of 2. Finally, elements 6, 7, and 8 have a level of 1. We also use Figure \ref{fig::Sn_Solution_Spatial_AMR_tree} to further define the concept of an {\em irregularity index}. This index is the difference in refinement levels between two adjoining mesh elements. The irregularity index for the face separating elements 6 and 7 is 0 since $\ell(6)=\ell(7)$. The irregularity index for the face separating elements 4 and 8 is 1 since $\ell(8)=1$ and $\ell(4)=2$. Finally, the irregularity index for the face separating elements 1 and 2 is 2 since $\ell(1)=0$ and $\ell(2)=2$. For the AMR problems in this work, we restrict the maximum allowable irregularity index for all of the elements for each of the mesh refinement levels.

Following a refinement cycle, we have a new adapted mesh, $\mathbb{T}_h^{r+1}$, but our current solution lives on $\mathbb{T}_h^{r}$. This means that the solution lives on a lower-dimensional space than the next solution on the newly adapted mesh. To solve for the transport solution on $\mathbb{T}_h^{r+1}$, we could simply reinitialize our solution vectors to zero and follow the procedures in Algorithm \ref{alg::Sn_Linear_Transport_Solve}. However, this means that the solution from mesh $\mathbb{T}_h^{r}$ would simply be discarded. This would discount all the work performed to compute the solution on level $r$. Furthermore, if there is little difference in the functional space between the two refinement cycles, then the calculated solution at level $r$ would be a good initial guess for the solution to be calculated for level $r+1$. For this reason, we define the concept of {\em bootstrapping}, which is the projection of the solution from $\mathbb{T}_h^{r}$ onto $\mathbb{T}_h^{r+1}$. Figure \ref{fig::Sn_Solution_Spatial_AMR_bootstrapping} provides an example of bootstrapping by refining a single unit square element onto the four identical daughter elements with $\frac{1}{4}$ the area as the parent element. Figure \ref{fig::Sn_Solution_Spatial_AMR_BS_before} shows a linear planar solution on a single unit square parent element. Then, after this element is refined, its solution is projected onto its four identical daughter elements. Figure \ref{fig::Sn_Solution_Spatial_AMR_BS_after} shows this bootstrapped solution onto the refined mesh, where we can clearly see that the projected solution lives in the dimensional space of the daughter elements but still lives in the functional space of the parent element.

\iffalse
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Numerical Results} \label{sec::results}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%------------------------------------------------------------------------------------------------------------
\subsection{Exactly-Linear Transport Solutions}
%------------------------------------------------------------------------------------------------------------

Our first numerical verification example demonstrates that the linear polygonal finite element basis functions capture an exactly-linear solution space. We will show this by the method of exact solutions (MES). We build our exact solution by investigating the 2D, 1 energy group transport problem with no scattering and an angle-dependent distributed source,

\begin{equation}
\label{eq::Results_Linear_angflux}
\mu \frac{\partial \psi}{\partial x} + \eta \frac{\partial \psi}{\partial y} + \sigma_t \psi = Q(x,y, \mu, \eta), 
\end{equation}

\noindent where the streaming term was separated into the corresponding two-dimensional terms. We then define an angular flux solution that is linear in both space and angle along with the corresponding 0th moment scalar flux ($\phi_{0,0} \rightarrow \phi$) solution:

\begin{equation}
\label{eq::BF_Results_Linear_fluxsols}
\begin{aligned}
\psi (x,y,\mu,\eta) &= ax + by + c \mu + d\eta + e\\
\phi (x,y) &= 2 \pi \left( ax + by  + e \right)
\end{aligned} .
\end{equation}

% Linear contour plots
\begin{figure}
\centering
{
	\begin{subfigure}[b]{0.45\textwidth}
		\centering
		\label{subfig::cart_wach_lin_sol}
		\includegraphics[width=\textwidth]{\BFfigpath{cart_WACHSPRESS_k1.eps}}
		\caption{Cartesian}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.45\textwidth}
		\centering
		\label{subfig::tri_wach_lin_sol}
		\includegraphics[width=\textwidth]{\BFfigpath{tri_WACHSPRESS_k1.eps}}
		\caption{Triangular}
	\end{subfigure}
}
\vspace{3mm}
{
	\begin{subfigure}[b]{0.45\textwidth}
		\centering
		\label{subfig::shes_quad_wach_lin_sol}
		\includegraphics[width=\textwidth]{\BFfigpath{shes_poly_WACHSPRESS_k1.eps}}
		\caption{Shestakov Polygons}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.45\textwidth}
		\centering
		\label{subfig::smooth_poly_wach_lin_sol}
		\includegraphics[width=\textwidth]{\BFfigpath{smooth_poly_WACHSPRESS_k1.eps}}
		\caption{Shestakov Polygons}
	\end{subfigure}
}
\vspace{3mm}
{
	\begin{subfigure}[b]{0.45\textwidth}
		\centering
		\label{subfig::z_quad_wach_lin_sol}
		\includegraphics[width=\textwidth]{\BFfigpath{z_quad_WACHSPRESS_k1.eps}}
		\caption{Z-Quadrilaterals}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.45\textwidth}
		\centering
		\label{subfig::z_poly_wach_lin_sol}
		\includegraphics[width=\textwidth]{\BFfigpath{z_poly_WACHSPRESS_k1.eps}}
		\caption{Z-Polygons}
	\end{subfigure}
}
\caption{Contour plots of the exactly-linear solution with the Wachspress basis functions.}
\label{fig::Results_Linear_wach_sol}
\end{figure}

%------------------------------------------------------------------------------------------------------------
\subsection{Exactly-Quadratic Transport Solutions}
%------------------------------------------------------------------------------------------------------------

The first problem interpolates the $\{ 1, x, y, x^2, xy, y^2 \}$ span of functions, which we denote with the following general and exactly-quadratic solution, $\{\psi_q, \phi_q\}$:

\begin{equation}
\label{eq::Results_Quadratic_fluxsols}
\begin{aligned}
\psi_q (x,y,\mu,\eta) &= a + bx + c y+ d xy + e x^2 + fy^2 \\
\phi_q (x,y) &= 2 \pi \left(  a + bx + c y+ d xy + e x^2 + fy^2 \right)
\end{aligned} 
\end{equation}

\noindent We clearly see that any combination of positive or negative (non-zero) values for the coefficients $a-f$ will span the quadratic serendipity space. The second problem contains terms up to $x^2 y^2$. This higher-order functional form has a solution, $\{ \psi_{x2y2}, \phi_{x2y2}\}$, given by the following

\begin{equation}
\label{eq::Results_x2y2_fluxsols}
\begin{aligned}
\psi_{x2y2} (x,y,\mu,\eta) &= x \left(L_x - x \right) y \left(L_y - y \right) \\
\phi_{x2y2} (x,y) &= 2 \pi x \left(L_x - x \right) y \left(L_y - y \right) 
\end{aligned} ,
\end{equation}

\noindent where $L_x$ and $L_y$ are the dimensions of the domain in $x$ and $y$.

% 1,x,y,x^2,xy,y^2 table
\begin{table}[hbt]
\caption{$L_2$-norm of the error in the quadratic solution spanning $\{ 1, x, y, x^2, xy, y^2 \}$ for the different quadratic serendipity basis functions on different mesh types.}
\centering
\def\arraystretch{1.25}
\begin{tabular}{|c|c|c|c|c|}
\hline
& \multicolumn{4}{c}{Basis Functions}\vline\\
\hline
Mesh Type & Wachspress & PWL& Mean Value& Max. Entropy \\
\hline
Cartesian&2.23e-13&7.25e-13&5.68e-14&5.65e-14\\
Triangular&7.85e-14&1.46e-13&2.52e-14&2.54e-13\\
Shes. Poly&1.14e-14&6.82e-14&5.75e-14&1.25e-13\\
Sine Poly&2.56e-13&4.15e-13&3.25e-13&6.37e-13\\
Z-Poly&5.24e-14&5.35e-14&1.68e-13&5.19e-14\\
Z-Quad&6.64e-14&4.42e-14&8.29e-14&6.82e-13\\
\hline
\end{tabular}
\end{table}

%
\begin{table}[hbt]
\caption{$L_2$-norm of the error in the quadratic solution containing the $x^2y^2$ term for the different quadratic serendipity basis functions on different mesh types.}
\centering
\def\arraystretch{1.25}
\begin{tabular}{|c|c|c|c|c|}
\hline
& \multicolumn{4}{c}{Basis Functions}\vline\\
\hline
Mesh Type & Wachspress & PWL& Mean Value& Max. Entropy \\
\hline
Cartesian&3.50e-06&2.72e-05&8.29e-06&3.86e-05\\
Triangular&5.13e-05&5.13e-05&5.13e-05&5.13e-05\\
Shes. Poly&3.97e-04&3.37e-04&2.81e-04&3.91e-04\\
Sine Poly&3.75e-05&1.22e-04&7.62e-05&1.39e-04\\
Z-Poly&2.93e-05&3.07e-05&2.59e-05&3.46e-05\\
Z-Quad&2.98e-05&8.73e-05&5.08e-05&1.17e-04\\
\hline
\end{tabular}
\end{table}

%------------------------------------------------------------------------------------------------------------
\subsection{Convergence Rate Analysis by the Method of Manufactured Solutions}
%------------------------------------------------------------------------------------------------------------
\tcr{no mention of irr}

The sinusoid flux solutions, \{$\psi_s$, $\phi_s$\}, have the following parameterized form,

\begin{equation}
\label{eq::Results_MMS_sinefluxsols}
\begin{aligned}
\psi_s (x,y) = &\sin(\nu  \frac{\pi x}{L_x}) \sin(\nu  \frac{\pi y}{L_y}), \\ 
\phi_s (x,y) = 2 \pi &\sin(\nu  \frac{\pi x}{L_x}) \sin(\nu  \frac{\pi y}{L_y}),
\end{aligned} 
\end{equation}

\noindent where $\nu$ is a frequency parameter. We restrict this parameter to positive integers ($\nu = 1,2,3,...$). The Gaussian solution space, \{$\psi_g$, $\phi_g$\}, that has its local maximum centered at ($x_0,y_0$) has the parameterized form,

\begin{equation}
\label{eq::BF_Results_MMS_gaussfluxsols}
\begin{aligned}
\psi_g (x,y) = &C_M x (L_x - x) y (L_y - y) \exp(-\frac{(x-x_0)^2 + (y-y_0)^2}{\gamma}), \\ 
\phi_g (x,y) = 2 \pi &C_M x (L_x - x) y (L_y - y) \exp(-\frac{(x-x_0)^2 + (y-y_0)^2}{\gamma}),
\end{aligned} 
\end{equation}

\noindent where the constants in the equations are:

\begin{equation}
\label{eq::BF_Results_MMS_gaussconsts}
C_M = \frac{100}{L_x^2 L_y^2} \qquad \gamma = \frac{L_x L_y}{100} .
\end{equation}

%------------------------------------------------------------------------------------------------------------
\subsection{Convergence Rate Analysis Bounded by the Solution Regularity}
%------------------------------------------------------------------------------------------------------------
\tcr{summarize results; give poly only for cv rate=1/2. put the 3/2 in appendix.}



% Left-face incidence mesh and solution
% ---------------------------------------------
\begin{figure}
\centering
	\begin{subfigure}[b]{0.425\textwidth}
		\centering
		\label{subfig::PA_MeshSol_Poly}
		\includegraphics[width=\textwidth]{\BFfigpath{PALeftSol_SplitPoly.png}}
		\caption{Split-Polygonal Mesh}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.425\textwidth}
		\centering
		\label{subfig::PA_MeshSol_SplitPoly}
		\includegraphics[width=\textwidth]{\BFfigpath{PALeftSol_Poly.png}}
		\caption{Polygonal Mesh}
	\end{subfigure}
\caption{Example solution of the purely-absorbing medium case with left-face incidence and $\sigma_t=1$ using the linear PWL basis functions.}
\label{fig::Results_PA_Left_Solutions}
\end{figure}

% p+1split-polygonal convergence rate plots - left-face incidence
% ---------------------------------------------------------------------------
\begin{figure}
\centering
{
	\begin{subfigure}[b]{0.485\textwidth}
		\centering
		\label{subfig::PA_Left_SplitPoly_sig1}
		\includegraphics[width=\textwidth]{\BFfigpath{PAErr_Left_SplitPoly_sig1.eps}}
	\caption{$\sigma_t = 1$}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.485\textwidth}
		\centering
		\label{subfig::PA_Left_SplitPoly_sig10}
		\includegraphics[width=\textwidth]{\BFfigpath{PAErr_Left_SplitPoly_sig10.eps}}
	\caption{$\sigma_t = 10$}
	\end{subfigure}
}
\vspace{1cm}
{
	\begin{subfigure}[b]{0.485\textwidth}
		\centering
		\label{subfig::PA_Left_SplitPoly_sig50}
		\includegraphics[width=\textwidth]{\BFfigpath{PAErr_Left_SplitPoly_sig50.eps}}
	\caption{$\sigma_t = 50$}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.485\textwidth}
		\centering
		\label{subfig::PA_Left_SplitPoly_sig100}
		\includegraphics[width=\textwidth]{\BFfigpath{PAErr_Left_SplitPoly_sig100.eps}}
	\caption{$\sigma_t = 100$}
	\end{subfigure}
}
\caption{Convergence rates for the pure absorber problem with left-face incidence on split-polygonal meshes with different values of $\sigma_t$.}
\label{fig::Results_PA_Left_SplitPoly}
\end{figure}


% 1/2 polygonal convergence rate plots - left-face incidence
% ---------------------------------------------------------------------
\begin{figure}
\centering
{
	\begin{subfigure}[b]{0.485\textwidth}
		\centering
		\label{subfig::PA_Left_Poly_sig1}
		\includegraphics[width=\textwidth]{\BFfigpath{PAErr_Left_Poly_sig1.eps}}
	\caption{$\sigma_t = 1$}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.485\textwidth}
		\centering
		\label{subfig::PA_Left_Poly_sig10}
		\includegraphics[width=\textwidth]{\BFfigpath{PAErr_Left_Poly_sig10.eps}}
	\caption{$\sigma_t = 10$}
	\end{subfigure}
}
\vspace{1cm}
{
	\begin{subfigure}[b]{0.485\textwidth}
		\centering
		\label{subfig::PA_Left_Poly_sig50}
		\includegraphics[width=\textwidth]{\BFfigpath{PAErr_Left_Poly_sig50.eps}}
	\caption{$\sigma_t = 50$}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.485\textwidth}
		\centering
		\label{subfig::PA_Left_Poly_sig100}
		\includegraphics[width=\textwidth]{\BFfigpath{PAErr_Left_Poly_sig100.eps}}
	\caption{$\sigma_t = 100$}
	\end{subfigure}
}
\caption{Convergence rates for the pure absorber problem with left-face incidence on polygonal meshes with different values of $\sigma_t$.}
\label{fig::Results_PA_Left_Poly}
\end{figure}

%------------------------------------------------------------------------------------------------------------
\subsection{Thick Diffusion Limit}
%------------------------------------------------------------------------------------------------------------
\tcr{\begin{itemize}
\item 1D unresolved boundary layer
\item 2D from dissertation
\end{itemize}}
\fi

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions} \label{sec::conclusions}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
In this paper...

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Acknowledgments} 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
This research was performed under appointment to the Rickover Graduate Fellowship Program in Nuclear Engineering sponsored by the Naval Reactors Division of the United States Department of Energy.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bibliographystyle{unsrt}
\bibliography{references}

% Begin appendices
\appendix
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Limits of the Barycentric Functions on the Boundary}  \label{app::bound}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conversion of the Serendipity Functions to the Lagrange Space}  \label{app::Lagrange}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\iffalse
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Additional Convergence Rate Analysis for Continuous Transport Solutions Bounded by the Solution Regularity}  \label{app::Lagrange}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% Left-face and top-face incidence mesh and solution
% ---------------------------------------------
\begin{figure}
\centering
	\begin{subfigure}[b]{0.425\textwidth}
		\centering
		\label{subfig::PA_MeshSol_Poly}
		\includegraphics[width=\textwidth]{\BFfigpath{PALeftTopSol_SplitPoly.png}}
		\caption{Split-Polygonal Mesh}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.425\textwidth}
		\centering
		\label{subfig::PA_MeshSol_SplitPoly}
		\includegraphics[width=\textwidth]{\BFfigpath{PALeftTopSol_Poly.png}}
		\caption{Polygonal Mesh}
	\end{subfigure}
\caption{Example solution of the purely-absorbing medium case with left-face and top-face incidence and $\sigma_t=1$ using the linear PWL basis functions.}
\label{fig::Results_PA_Left_Solutions}
\end{figure}

% p+1split-polygonal convergence rate plots - left-face incidence
% ---------------------------------------------------------------------------
\begin{figure}
\centering
{
	\begin{subfigure}[b]{0.485\textwidth}
		\centering
		\label{subfig::PA_LeftTop_SplitPoly_sig1}
		\includegraphics[width=\textwidth]{\BFfigpath{PAErr_LeftTop_SplitPoly_sig1.eps}}
	\caption{$\sigma_t = 1$}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.485\textwidth}
		\centering
		\label{subfig::PA_LeftTop_SplitPoly_sig10}
		\includegraphics[width=\textwidth]{\BFfigpath{PAErr_LeftTop_SplitPoly_sig10.eps}}
	\caption{$\sigma_t = 10$}
	\end{subfigure}
}
\vspace{1cm}
{
	\begin{subfigure}[b]{0.485\textwidth}
		\centering
		\label{subfig::PA_LeftTop_SplitPoly_sig50}
		\includegraphics[width=\textwidth]{\BFfigpath{PAErr_LeftTop_SplitPoly_sig50.eps}}
	\caption{$\sigma_t = 50$}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.485\textwidth}
		\centering
		\label{subfig::PA_LeftTop_SplitPoly_sig100}
		\includegraphics[width=\textwidth]{\BFfigpath{PAErr_LeftTop_SplitPoly_sig100.eps}}
	\caption{$\sigma_t = 100$}
	\end{subfigure}
}
\caption{Convergence rates for the pure absorber problem with left-face and top-face incidence on split-polygonal meshes with different values of $\sigma_t$.}
\label{fig::Results_PA_Left_SplitPoly}
\end{figure}


% 1/2 polygonal convergence rate plots - left-face incidence
% ---------------------------------------------------------------------
\begin{figure}
\centering
{
	\begin{subfigure}[b]{0.485\textwidth}
		\centering
		\label{subfig::PA_LeftTop_Poly_sig1}
		\includegraphics[width=\textwidth]{\BFfigpath{PAErr_LeftTop_Poly_sig1.eps}}
	\caption{$\sigma_t = 1$}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.485\textwidth}
		\centering
		\label{subfig::PA_LeftTop_Poly_sig10}
		\includegraphics[width=\textwidth]{\BFfigpath{PAErr_LeftTop_Poly_sig10.eps}}
	\caption{$\sigma_t = 10$}
	\end{subfigure}
}
\vspace{1cm}
{
	\begin{subfigure}[b]{0.485\textwidth}
		\centering
		\label{subfig::PA_LeftTop_Poly_sig50}
		\includegraphics[width=\textwidth]{\BFfigpath{PAErr_LeftTop_Poly_sig50.eps}}
	\caption{$\sigma_t = 50$}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.485\textwidth}
		\centering
		\label{subfig::PA_LeftTop_Poly_sig100}
		\includegraphics[width=\textwidth]{\BFfigpath{PAErr_LeftTop_Poly_sig100.eps}}
	\caption{$\sigma_t = 100$}
	\end{subfigure}
}
\caption{Convergence rates for the pure absorber problem with left-face and top-face incidence on polygonal meshes with different values of $\sigma_t$.}
\label{fig::Results_PA_Left_Poly}
\end{figure}

\fi
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
